<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Iris Prediction Pipeline</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="/static/css/styles.css">
</head>
<body>
    <h1>Iris Prediction and Visualization Pipeline</h1>

    <!-- Prediction Form -->
    <section>
        <h2>Predict Iris Species</h2>
        <form id="predict-form">
            <input type="number" step="0.1" name="sepal_length" placeholder="Sepal Length (cm)" required>
            <input type="number" step="0.1" name="sepal_width" placeholder="Sepal Width (cm)" required>
            <input type="number" step="0.1" name="petal_length" placeholder="Petal Length (cm)" required>
            <input type="number" step="0.1" name="petal_width" placeholder="Petal Width (cm)" required>
            <button type="submit">Predict</button>
        </form>
        <div id="prediction-result" class="result"></div>
    </section>

    <!-- Default Visualizations -->
    <section>
        <h2>Default Visualizations</h2>
        <div class="plot-container">
            <div class="plot-wrapper">
                <div class="plot-title" id="scatter-plot-title">Petal Length vs Petal Width</div>
                <div class="plot" id="scatter-plot"></div>
                <div class="plot-description" id="scatter-description"></div>
            </div>
            <div class="plot-wrapper">
                <div class="plot-title" id="box-plot-title">Petal Length Distribution by Species</div>
                <div class="plot" id="box-plot"></div>
                <div class="plot-description" id="box-description"></div>
            </div>
            <div class="plot-wrapper pairplot">
                <div class="plot-title" id="pair-plot-title">Pairplot of Iris Features by Species</div>
                <div class="plot" id="pair-plot"></div>
                <div class="plot-description" id="pair-description"></div>
            </div>
        </div>
    </section>

    <!-- Custom Visualization Form -->
    <section>
        <h2>Custom Visualization</h2>
        <form id="visualization-form">
            <select name="plot_type">
                <option value="scatter">Scatter</option>
                <option value="boxplot">Boxplot</option>
                <option value="pairplot">Pairplot</option>
            </select>
            <input type="text" name="features" placeholder="Features (comma-separated, e.g., sepal length (cm),petal width (cm))">
            <button type="submit">Generate Visualization</button>
        </form>
        <div id="custom-plots"></div>
    </section>

    <!-- Upload and Retrain -->
    <section>
        <h2>Upload New Data</h2>
        <label for="file-upload" class="file-upload">
            <svg width="50" height="50" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M7 10V9C7 6.23858 9.23858 4 12 4C14.7614 4 17 6.23858 17 9V10C19.2091 10 21 11.7909 21 14C21 16.2091 19.2091 18 17 18H7C4.79086 18 3 16.2091 3 14C3 11.7909 4.79086 10 7 10Z" stroke="#3a7bd5" stroke-width="2"/>
                <path d="M12 12L12 15" stroke="#3a7bd5" stroke-width="2" stroke-linecap="round"/>
                <path d="M14 14L12 12L10 14" stroke="#3a7bd5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <div style="margin-top: 16px; text-align: center;">
                <strong>Drop your CSV file here</strong>
                <p style="margin-top: 8px; color: #718096;">or click to browse</p>
            </div>
        </label>
        <form id="upload-form" enctype="multipart/form-data">
            <input id="file-upload" type="file" name="file" accept=".csv" style="display: none;" required>
            <button type="submit">Upload CSV File</button>
        </form>
        <div id="upload-result" class="result"></div>
        <button id="retrain-button">Retrain Model</button>
        <div id="retrain-result" class="result"></div>
        <div id="retrain-choice" class="hidden">
            <div class="model-comparison">
                <div class="model-card">
                    <div class="model-label">Old Model Accuracy</div>
                    <div id="old-accuracy" class="accuracy-value">-</div>
                </div>
                <div class="model-card">
                    <div class="model-label">New Model Accuracy</div>
                    <div id="new-accuracy" class="accuracy-value">-</div>
                </div>
            </div>
            <div class="choice-buttons">
                <button id="save-button">Save New Model</button>
                <button id="discard-button">Discard New Model</button>
            </div>
        </div>
    </section>

    <!-- Evaluation -->
    <section>
        <h2>Evaluate Model</h2>
        <button id="evaluate-button">Evaluate Current Model</button>
        <pre id="evaluation-result" class="result"></pre>
    </section>

    <!-- Snackbar Container -->
    <div id="snackbar"></div>

    <!-- Progress Overlay -->
    <div class="progress-overlay" id="progress-overlay">
        <div class="progress-card">
            <div class="spinner"></div>
            <div class="progress-message">Model Retraining in Progress...</div>
            <div class="progress-bar-container">
                <div class="progress-bar"></div>
            </div>
            <div style="color: #718096; font-size: 14px;">This may take a few moments</div>
        </div>
    </div>

    <script src="/static/js/scripts.js"></script>
</body>
</html>
